package:
  name: blackfire
  version: 2.30.2
  epoch: 0
  description: "Blackfire CLI"
  copyright:
    - license: PROPRIETARY
  options:
    no-provides: true

environment:
  contents:
    packages:
      - bash
      - busybox
      - curl

pipeline:
  - uses: fetch
    if: ${{build.arch}} == 'x86_64'
    with:
      uri: https://blackfire.io/api/v1/releases/cli/linux/x86_64
      expected-sha512: adf2fab0c6680124da928fac9ba0e1bfcc4ddae63a29b168028e0b34927ed016b954698134473badf6472acc4e546a76e5873b5d50b6533c5268ab1c79fd6ed9

  - uses: fetch
    if: ${{build.arch}} == 'aarch64'
    with:
      uri: https://blackfire.io/api/v1/releases/cli/linux/aarch64
      expected-sha512: bbb1b509f85e8e76f461164d5e08cbc9045d10761e77839ef0544c35d706f2e7b57f56a78c21be8b769c46c572e3b55ba76cab2d05e0f980ec3b57ed28e4de0c

  - runs: |
      tar xfv ${{build.arch}}
      mkdir -p ${{targets.destdir}}/usr/bin
      mv blackfire ${{targets.destdir}}/usr/bin/

update:
  enabled: true
  release-monitor:
    identifier: 372834

test:
  pipeline:
    - runs: |
        blackfire version
