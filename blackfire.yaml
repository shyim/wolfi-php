package:
  name: blackfire
  version: 2.29.3
  epoch: 0
  description: "Blackfire CLI"
  copyright:
    - license: PROPRIETARY
  options:
    no-provides: true

environment:
  contents:
    packages:
      - bash
      - busybox
      - curl

pipeline:
  - uses: fetch
    if: ${{build.arch}} == 'x86_64'
    with:
      uri: https://blackfire.io/api/v1/releases/cli/linux/x86_64
      expected-sha512: 9a0a9f5dbff618efca09a129e8b0d512405c47d4574c2245f2de1222c3c4f38de4f04cbe70d70fcbeb4dbcd82fd1fe37f137a6fe8249887b6a6a5277a0e9f0b6

  - uses: fetch
    if: ${{build.arch}} == 'aarch64'
    with:
      uri: https://blackfire.io/api/v1/releases/cli/linux/aarch64
      expected-sha512: ba84b845e467129fbd88c013093d5da7826d56461881efd50370188143e4f36b7d179d1beb246d745dbea6a8d9bdd6e357b2b8786237cb6ab081ce11b1898874

  - runs: |
      tar xfv ${{build.arch}}
      mkdir -p ${{targets.destdir}}/usr/bin
      mv blackfire ${{targets.destdir}}/usr/bin/

update:
  enabled: true
  release-monitor:
    identifier: 372834

test:
  pipeline:
    - runs: |
        blackfire version
