package:
  name: blackfire
  version: 2.30.1
  epoch: 0
  description: "Blackfire CLI"
  copyright:
    - license: PROPRIETARY
  options:
    no-provides: true

environment:
  contents:
    packages:
      - bash
      - busybox
      - curl

pipeline:
  - uses: fetch
    if: ${{build.arch}} == 'x86_64'
    with:
      uri: https://blackfire.io/api/v1/releases/cli/linux/x86_64
      expected-sha512: b4a0c3508287fafb3d9f0e839baf53a937c6cf75fa1058c94371558488641ea5a99c717ba58fe357b46e691816ea2bf266c82581c0a6befb335324b2019d2c64

  - uses: fetch
    if: ${{build.arch}} == 'aarch64'
    with:
      uri: https://blackfire.io/api/v1/releases/cli/linux/aarch64
      expected-sha512: 0324e058dd572905ebaa5ac69a4f63fe0aab3b22b0d08a7fc2512b105d6cb76e7071c5e15d1ae5ed9899a57e5910f8190634526d9521c2c3c303b2927ce29d88

  - runs: |
      tar xfv ${{build.arch}}
      mkdir -p ${{targets.destdir}}/usr/bin
      mv blackfire ${{targets.destdir}}/usr/bin/

update:
  enabled: true
  release-monitor:
    identifier: 372834

test:
  pipeline:
    - runs: |
        blackfire version
